function T = tvi_ferwerda( L_adapt )
%% Threshold versus Intensity function
  % Proposed by Ferwerda'96
  % L_adapt - adapting luminance
  % T - absolute perceivable threshold
  logL_adapt = log10( L_adapt );
  logT = ...
      (logL_adapt < -3.94) * -2.86 + ...
      (logL_adapt >= -3.94) .* (logL_adapt < -1.44) .* ...
         ((0.405*logL_adapt+1.6).^2.18-2.86) + ...
      (logL_adapt >= -1.44) .* (logL_adapt < -0.0184) .* ...
         (logL_adapt - 0.395) + ...
      (logL_adapt >= -0.0184) .* (logL_adapt < 1.9) .* ...
         ((0.249*logL_adapt+0.65).^2.7 - 0.72) + ...
      (logL_adapt >= 1.9) .* (logL_adapt - 1.255);
  T = 10.^logT-0.95;
end

